<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cinematic Counter-Cartographies</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* --- Restore original color scheme --- */
body {
  background: #f7f6f2;
  color: #222;
}

/* Navbar */
.topnav {
      background: #0a2321;
      color: #eaf7f2;
      padding: 0 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
      box-shadow: 0 2px 12px rgba(2,36,32,0.08);
      position: sticky;
      top: 0;
      z-index: 10;
}
.topnav .brand {
  color: #222;
}
.topnav .menu a {
  color: #222;
}
.topnav .menu a.active,
.topnav .menu a:hover {
  color: #288366;
  border-bottom: 2px solid #288366;
}

/* Olive branch icon */
.olive-branch-icon svg path,
.olive-branch-icon svg ellipse {
  stroke: #708238;
  fill: #708238;
}

/* Search box */
.site-search-container {
  background: none;
}
#site-search-input {
  border: 1px solid #288366;
  background: #fff;
  color: #222;
}
#site-search-input:focus {
  border-color: #288366;
  box-shadow: 0 0 0 2px #288366;
}
#site-search-btn {
  background: #288366;
  color: #fff;
}
#site-search-btn:hover {
  background: #e6a93a;
  color: #222;
}
#site-search-results div {
  background: #f7f6f2;
  color: #222;
}
#site-search-results a {
  color: #288366;
}
#site-search-results mark {
  background: #e6a93a;
  color: #222;
}

/* Hero/title section */
.hero-moth {
  background: #f7f6f2;
  color: #222;
}
.hero-moth .hero-title {
  color: #222;
}

/* Cutout/ransom note title */
.paper-title .paper-piece {
  border: 2.5px solid #fff;
  box-shadow: 2px 4px 12px rgba(0,0,0,0.13), 0 0.5px 0.5px #fff inset;
}
.paper-piece {
  /* Assign cutout backgrounds and text colors using the palette */
}
.paper-piece[style*="background:#fff"] { color: #222; }
.paper-piece[style*="background:#b94e3a"] { color: #fff; }
.paper-piece[style*="background:#e6a93a"] { color: #222; }
.paper-piece[style*="background:#6fe7c1"] { color: #222; }
.paper-piece[style*="background:#4e2e1e"] { color: #fff; }
.paper-piece[style*="background:#222"] { color: #fff; }

/* Quote slideshow */
.moth-quote-hero {
  background: #f7f6f2;
  color: #222;
}
.quote-slide {
  background: #fff;
  color: #222;
}
.quote-author {
  color: #288366;
}

/* Divider aesthetic */
.divider-content {
  background: #fff;
  border-radius: 24px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
}

/* Cards and grid */
.moth-card {
  background: #fff;
  color: #222;
}
.moth-card h2 {
  color: #288366;
}
.moth-card p {
  color: #444;
}
.moth-card .btn {
  background: #288366;
  color: #fff;
}
.moth-card .btn:hover {
  background: #e6a93a;
  color: #222;
}

/* Questions section */
.questions-moth,
.enhanced-questions {
  background: #f7f6f2;
  color: #222;
}
.enhanced-questions li {
  background: #fff;
  border-left: 4px solid #288366;
  color: #222;
}
.enhanced-questions li:hover {
  background: #e6a93a;
  color: #222;
}
.enhanced-questions p,
.enhanced-questions .questions-summary {
  background: #fff;
  color: #222 !important;
}

/* Footer */
.footer {
  background: #fff;
  color: #888;
  text-align: center;
  padding: 1.5rem 0 1rem 0;
  font-size: 1rem;
  letter-spacing: 0.01em;
}
  </style>
</head>
<body>
  <nav class="topnav">
    <div class="brand" style="display: flex; align-items: center; gap: 0.7rem;">
      <!-- Olive branch SVG icon (olive-toned green version, larger size, inspired by Freepik) -->
      <span class="olive-branch-icon" style="width: 44px; height: 44px;">
        <svg width="44" height="44" viewBox="0 0 44 44" fill="none" aria-label="Olive branch" style="vertical-align:middle;">
          <!-- Curved branch -->
          <path d="M10 34 Q22 18 36 28" stroke="#708238" stroke-width="2.5" fill="none" stroke-linecap="round"/>
          <!-- Leaves (pointed, stylized) -->
          <path d="M15 29 Q17 26 20 28 Q18 30 15 29Z" fill="#8A9A5B" opacity="0.9"/>
          <path d="M22 23 Q24 20 27 22 Q25 24 22 23Z" fill="#8A9A5B" opacity="0.9"/>
          <path d="M30 27 Q32 24 35 26 Q33 28 30 27Z" fill="#8A9A5B" opacity="0.9"/>
          <!-- Olives (oval, stylized) -->
          <ellipse cx="18" cy="30" rx="1.5" ry="2.2" fill="#708238" opacity="1"/>
          <ellipse cx="25" cy="25" rx="1.5" ry="2.2" fill="#708238" opacity="1"/>
          <ellipse cx="33" cy="29" rx="1.5" ry="2.2" fill="#708238" opacity="1"/>
        </svg>
      </span>
      Cinematic Counter‑Cartographies
    </div>
    <div class="menu">
      <a href="index.html" class="active">Home</a>
      <a href="map.html">Map & Archive</a>
      <a href="checkpoints.html">Checkpoints</a>
      <a href="analysis.html">Visual Analysis</a>
      <a href="not-mapped.html">What's Not Mapped</a>
    </div>
  </nav>

  <!-- SEARCH BOX SECTION -->
  <div class="site-search-container" role="search" aria-label="Site search">
    <form id="site-search-form" autocomplete="off" style="display:flex;align-items:center;gap:0.3rem;">
      <span class="search-icon" aria-hidden="true" style="font-size:1.3rem;color:#6fe7c1;">
        <!-- Magnifying glass SVG -->
        <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
          <circle cx="10" cy="10" r="8" stroke="#6fe7c1" stroke-width="2"/>
          <line x1="16" y1="16" x2="21" y2="21" stroke="#6fe7c1" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </span>
      <input 
        type="search" 
        id="site-search-input" 
        placeholder="Search the site..." 
        aria-label="Search the site"
        maxlength="40"
        style="padding:0.4rem 0.8rem;border-radius:2em;border:1px solid #6fe7c1;font-size:1rem;width:210px;max-width:90vw;background:#0a2321;color:#eaf7f2;outline:none;"
      >
      <button 
        type="submit" 
        id="site-search-btn"
        style="padding:0.4rem 1.1rem;border-radius:2em;background:rgba(111,231,193,0.45);color:#0a2321;font-weight:bold;border:none;font-size:0.98rem;cursor:pointer;transition:background 0.18s;"
      >Search</button>
    </form>
    <div id="site-search-suggestions" style="display:none;"></div>
    <div id="site-search-results"></div>
  </div>

  <!-- HERO TITLE SECTION (keep only the title here) -->
  <header class="hero-moth">
    <div class="hero-title newspaper-title paper-title">
      <span class="paper-piece" style="color:#222;background:#fff;">C</span>
      <span class="paper-piece" style="color:#fff;background:#b94e3a;">i</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">n</span>
      <span class="paper-piece" style="color:#fff;background:#222;">e</span>
      <span class="paper-piece" style="color:#e6a93a;background:#fff;">m</span>
      <span class="paper-piece" style="color:#b94e3a;background:#fff;">a</span>
      <span class="paper-piece" style="color:#fff;background:#288366;">t</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">i</span>
      <span class="paper-piece" style="color:#fff;background:#4e2e1e;">c</span>
      <span> </span>
      <span class="paper-piece" style="color:#fff;background:#0e6e4f;">C</span>
      <span class="paper-piece" style="color:#fff;background:#b94e3a;">o</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">u</span>
      <span class="paper-piece" style="color:#fff;background:#4e2e1e;">n</span>
      <span class="paper-piece" style="color:#e6a93a;background:#fff;">t</span>
      <span class="paper-piece" style="color:#b94e3a;background:#fff;">e</span>
      <span class="paper-piece" style="color:#fff;background:#6fe7c1;">r</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">-</span>
      <span class="paper-piece" style="color:#fff;background:#4e2e1e;">C</span>
      <span class="paper-piece" style="color:#e6a93a;background:#fff;">a</span>
      <span class="paper-piece" style="color:#b94e3a;background:#fff;">r</span>
      <span class="paper-piece" style="color:#fff;background:#105540;">t</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">o</span>
      <span class="paper-piece" style="color:#fff;background:#4e2e1e;">g</span>
      <span class="paper-piece" style="color:#e6a93a;background:#fff;">r</span>
      <span class="paper-piece" style="color:#b94e3a;background:#fff;">a</span>
      <span class="paper-piece" style="color:#fff;background:#0a4532;">p</span>
      <span class="paper-piece" style="color:#fff;background:#e6a93a;">h</span>
      <span class="paper-piece" style="color:#fff;background:#4e2e1e;">i</span>
      <span class="paper-piece" style="color:#e6a93a;background:#fff;">e</span>
      <span class="paper-piece" style="color:#b94e3a;background:#fff;">s</span>
    </div>
  </header>

  <!-- QUOTE SLIDESHOW HERO SECTION -->
  <section class="moth-quote-hero">
    <div class="quote-bg-slideshow" id="quote-bg-slideshow" style="display: flex; align-items: center; justify-content: center; position: relative;">
      <!-- Left Arrow -->
      <button id="quote-prev" aria-label="Previous quote" style="
        position: absolute;
        left: 8%;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(111,231,193,0.18);
        border: none;
        color: #6fe7c1;
        font-size: 2.6rem;
        cursor: pointer;
        z-index: 3;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s, color 0.2s;
      ">&#8592;</button>
      <!-- Centered image -->
      <div id="quote-image-container" style="
        width: 340px;
        height: 220px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(10,35,33,0.18);
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 2px 12px rgba(2,36,32,0.12);
        margin: 0 60px;
        position: relative;
        z-index: 2;
      ">
        <img id="quote-image" src="" alt="Checkpoint" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          border-radius: 18px;
          display: block;
        ">
      </div>
      <!-- Right Arrow -->
      <button id="quote-next" aria-label="Next quote" style="
        position: absolute;
        right: 8%;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(111,231,193,0.18);
        border: none;
        color: #6fe7c1;
        font-size: 2.6rem;
        cursor: pointer;
        z-index: 3;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s, color 0.2s;
      ">&#8594;</button>
    </div>
    <div class="quote-slideshow" id="quote-slideshow" style="position:relative; margin-top: 1.2rem;">
      <div class="quote-slide active">
        “The arbitrariness of what happens inside a checkpoint in terms of soldiers’ control of Palestinians’ time is further comparable to forms of solitary confinement.”
        <span class="quote-author">Helga Tawil-Souri</span>
      </div>
      <div class="quote-slide">
        “The desire to express in an art form and to compose a tableau and vignette whether it's humorous, burlesque, or poetic comes simply from a desire to compose an image for cinema. It is not my fault that when I go to Ramallah there is a checkpoint and therefore it enters my film. Tell me a way to avoid that politicized image. The fact is that the police are everywhere, the army everywhere and occupation is total. Whether it's a love story or a thriller, you place the camera and these realities will cross the frame.”
        <span class="quote-author">Elia Suleiman</span>
      </div>
      <div class="quote-slide">
        “Traveling through a checkpoint is a confining and asphyxiating experience.”
        <span class="quote-author">Helga Tawil-Souri</span>
      </div>
      <div class="quote-slide">
        “People are trained to listen for the ‘click’ of the turnstiles and to accept that their fate and time is not under their control.”
        <span class="quote-author">Helga Tawil-Souri</span>
      </div>
      <div class="quote-slide">
        “Many of the people in Israel don't really perceive the true meaning of being an occupying nation. How does it affect us and how does it affect the Palestinians? What does it mean for a Palestinian to live under occupation; how does it feel every time you want to go to work, school, or to a doctor or just to visit friends you have to go through these checkpoints? How does it feel to be a young soldier who has to stand in that impossible situation? To face civilians, to handle situations he was not trained for? To have so much power over other people's lives. How does it affect that soldier? How does it affect our society?”
        <span class="quote-author">Yoav Shamir</span>
      </div>
    </div>
  </section>

  <!-- ADDITIONAL DECORATIVE DIVIDER SECTION -->
  <section class="divider-aesthetic">
    <div class="divider-content">
      <svg width="320" height="48" viewBox="0 0 320 48" fill="none" aria-label="Olive divider" style="vertical-align:middle;">
        <!-- Longer, more curved olive branch -->
        <path d="M20 38 Q160 -10 300 38" stroke="#8A9A5B" stroke-width="4" fill="none" stroke-linecap="round"/>
        <!-- Olives -->
        <ellipse cx="70" cy="22" rx="7" ry="11" fill="#708238"/>
        <ellipse cx="160" cy="10" rx="7" ry="11" fill="#708238"/>
        <ellipse cx="250" cy="22" rx="7" ry="11" fill="#708238"/>
        <!-- Leaves -->
        <path d="M45 32 Q65 8 85 28" stroke="#8A9A5B" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        <path d="M120 18 Q140 -2 170 16" stroke="#8A9A5B" stroke-width="2.5" fill="none" stroke-linecap="round"/>
        <path d="M210 28 Q230 4 260 30" stroke="#8A9A5B" stroke-width="2.5" fill="none" stroke-linecap="round"/>
      </svg>
    </div>
  </section>

  <section class="questions-moth enhanced-questions">
    <div class="questions-inner">
      <div class="questions-icon">
        <svg width="48" height="48" fill="none" viewBox="0 0 48 48">
          <circle cx="24" cy="24" r="22" stroke="#6fe7c1" stroke-width="3" fill="rgba(111,231,193,0.07)"/>
          <text x="24" y="32" text-anchor="middle" font-size="28" font-family="Arial" fill="#6fe7c1" font-weight="bold">?</text>
        </svg>
      </div>
      <h3>Questions Guiding This Project</h3>
      <ul>
        <li>How do camera angles refuse the surveillance gaze?</li>
        <li>What do ellipses and offscreen space keep from view?</li>
        <li>How does editing create a counternarrative to security footage?</li>
        <li>What is the politics of what these filmmakers choose not to show?</li>
      </ul>
      <p class="questions-summary">
        For this project, I analyze three to five significant checkpoints, including a prison checkpoint, and how they appear in films released from 2000 to 2025, to highlight how these same spaces are cinematically reimagined and captured over time. In this way, each checkpoint exists as a case study in cinematic resistance.<br>
        The section <strong>“What’s Not Mapped”</strong> explores moments of refusal, gaps in the archive, and the politics of cinematic omission.
      </p>
    </div>
  </section>

  <section class="moth-grid">
    <a href="map.html" class="moth-card">
      <h2>Map & Archive</h2>
      <p>Explore an interactive map and film archive of checkpoint locations and scenes from Palestinian cinema.</p>
      <span class="btn">Explore Map</span>
    </a>
    <a href="checkpoints.html" class="moth-card">
      <h2>Checkpoints</h2>
      <p>Browse case studies of key checkpoints and their cinematic representations.</p>
      <span class="btn">View Checkpoints</span>
    </a>
    <a href="analysis.html" class="moth-card">
      <h2>Visual Analysis</h2>
      <p>See visual breakdowns, charts, and film stills that reveal how filmmakers reimagine surveillance spaces.</p>
      <span class="btn">See Analysis</span>
    </a>
    <a href="not-mapped.html" class="moth-card">
      <h2>What’s Not Mapped</h2>
      <p>Discover moments of refusal, gaps in the archive, and the politics of cinematic omission.</p>
      <span class="btn">Learn More</span>
    </a>
  </section>

  <footer class="footer">© 2026 Cinematic Counter‑Cartographies</footer>
  <script>
    // Images matched to each quote's theme/content:
    const bgForQuote = [
      // 1. “The arbitrariness of what happens inside a checkpoint ... solitary confinement.”
      "assets/images/checkp1.jpg", // Suggests confinement, checkpoint interior

      // 2. “The desire to express in an art form ... occupation is total.”
      "assets/images/cp6.jpg", // Artistic, wide shot, occupation visible

      // 3. “Traveling through a checkpoint is a confining and asphyxiating experience.”
      "assets/images/checkp2.jpg", // Crowded, tense checkpoint

      // 4. “People are trained to listen for the ‘click’ of the turnstiles ...”
      "assets/images/cp5.jpg", // Turnstile or checkpoint machinery

      // 5. “Many of the people in Israel don't really perceive ... how does it affect our society?”
      "assets/images/checkp3.jpg" // Broader, societal, soldiers and civilians
    ];

    // Quote durations in milliseconds (longer for longer quotes)
    const quoteDurations = [
      7000, // 1. “The arbitrariness ... solitary confinement.” (long)
      12000, // 2. “The desire to express ... occupation is total.” (very long)
      7000, // 3. “Traveling through a checkpoint ...” (medium)
      6000, // 4. “People are trained to listen ...” (shorter)
      10000 // 5. “Many of the people in Israel ...” (long)
    ];

    const slides = document.querySelectorAll('.quote-slide');
    const quoteImg = document.getElementById('quote-image');
    let current = 0;
    let timer = null;

    function showSlide(idx) {
      slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === idx);
      });
      current = idx;
      if(quoteImg && bgForQuote.length) {
        quoteImg.src = bgForQuote[idx % bgForQuote.length];
      }
      // Clear and restart timer with appropriate duration
      clearInterval(timer);
      timer = setInterval(nextSlide, quoteDurations[idx % quoteDurations.length]);
    }

    function nextSlide() {
      showSlide((current + 1) % slides.length);
    }
    function prevSlide() {
      showSlide((current - 1 + slides.length) % slides.length);
    }

    document.getElementById('quote-next').addEventListener('click', () => {
      nextSlide();
    });
    document.getElementById('quote-prev').addEventListener('click', () => {
      prevSlide();
    });

    // Initialize first image and quote
    showSlide(0);

    /*
      Simple site-wide search for static pages.
      Add this script after your other scripts.
      You must add page content to the 'sitePages' array below.
      For best results, add a summary or main text for each page.
    */
    const sitePages = [
      {
        title: "Home",
        url: "index.html",
        content: `
          Cinematic Counter‑Cartographies. My research project explores how Palestinian women filmmakers such as Mai Masri, Annemarie Jacir, and Farah Nablusi create counter-cartographies through their cinematic work and their treatment of Israeli checkpoints. Questions: camera angles, surveillance gaze, ellipses, offscreen space, counternarrative, security footage, what's not mapped.
        `
      },
      {
        title: "Map & Archive",
        url: "map.html",
        content: `
          Interactive map and film archive of checkpoint locations and scenes from Palestinian cinema. Search for films, directors, and checkpoint locations.
        `
      },
      {
        title: "Checkpoints",
        url: "checkpoints.html",
        content: `
          Case studies of key checkpoints and their cinematic representations. Includes Qalandiya, Bethlehem, Huwwara, prison checkpoints, and more.
        `
      },
      {
        title: "Visual Analysis",
        url: "analysis.html",
        content: `
          Visual breakdowns, charts, and film stills that reveal how filmmakers reimagine surveillance spaces. Includes analysis of camera angles, editing, and cinematic resistance.
        `
      },
      {
        title: "What's Not Mapped",
        url: "not-mapped.html",
        content: `
          Moments of refusal, gaps in the archive, and the politics of cinematic omission. Explore what filmmakers choose not to show.
        `
      }
    ];

    // Add this after your sitePages array and before searchSite()
    function getPageText() {
      // Get all visible text from the body, excluding nav and footer
      const exclude = ['nav', 'footer', 'form', 'input', 'button', 'script', 'style'];
      let text = '';
      document.body.querySelectorAll('*').forEach(el => {
        if (!exclude.includes(el.tagName.toLowerCase())) {
          text += ' ' + (el.innerText || '');
        }
      });
      return text.replace(/\s+/g, ' ').trim();
    }

    // Add homepage actual text to the search index
    sitePages[0].content += ' ' + getPageText();

    function searchSite(query) {
      query = query.trim().toLowerCase();
      if (!query) return [];
      let expanded = [query, ...getSynonyms(query)];
      return sitePages
        .map(page => {
          let matchTitle = expanded.some(q => typoMatch(q, page.title.toLowerCase()));
          let matchContent = expanded.some(q => typoMatch(q, page.content.toLowerCase()));
          if (matchTitle || matchContent) {
            // Highlight matches in results
            const regex = new RegExp(`(${expanded.join('|')})`, 'gi');
            return {
              ...page,
              snippet: page.content.replace(regex, '<mark>$1</mark>')
            };
          }
          return null;
        })
        .filter(Boolean);
    }

    document.getElementById('site-search-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const query = document.getElementById('site-search-input').value;
      const results = searchSite(query);
      const resultsDiv = document.getElementById('site-search-results');
      document.getElementById('site-search-suggestions').style.display = 'none';
      if (results.length === 0) {
        resultsDiv.innerHTML = `<div style="color:#b9e3d4;padding:1rem;text-align:center;">No results found.</div>`;
      } else {
        resultsDiv.innerHTML = `
          <div style="
            max-height: 260px;
            overflow-y: auto;
            background: rgba(111,231,193,0.13);
            border-radius: 12px;
            padding: 0.5rem 0.5rem;
          ">
            <div style="color:#6fe7c1;font-weight:bold;padding:0.3rem 0.7rem 0.2rem 0;">
              ${results.length} result${results.length > 1 ? 's' : ''} found
            </div>
            ${results.map(r => `
              <div style="
                background: rgba(10,35,33,0.18);
                margin: 0.5rem 0;
                padding: 0.7rem 1rem;
                border-radius: 10px;
                box-shadow: 0 1px 6px rgba(111,231,193,0.06);
                color: #eaf7f2;
                font-size: 0.97rem;
                opacity: 0.92;
              ">
                <a href="${r.url}" style="font-size:1.08rem;color:#6fe7c1;font-weight:bold;text-decoration:none;">${r.title}</a>
                <div style="margin-top:0.4rem;">
                  ${r.snippet.length > 180 
                    ? r.snippet.slice(0, 180) + '...'
                    : r.snippet}
                </div>
              </div>
            `).join('')}
          </div>
        `;
      }
    });

    // Synonyms and typo tolerance dictionary
    const synonyms = {
      'checkpoint': ['checkpoints', 'border', 'gate', 'barrier'],
      'film': ['movie', 'cinema', 'director'],
      'archive': ['map', 'collection', 'database'],
      'palestinian': ['palestine', 'west bank', 'gaza'],
      'surveillance': ['security', 'camera', 'monitoring'],
      'refusal': ['resistance', 'omission', 'gap'],
      // Add more as needed
    };

    function getSynonyms(word) {
      return synonyms[word] || [];
    }

    // Basic typo tolerance (Levenshtein distance 1)
    function typoMatch(query, text) {
      if (text.includes(query)) return true;
      for (let i = 0; i < query.length; i++) {
        let typo = query.slice(0, i) + query.slice(i + 1);
        if (text.includes(typo)) return true;
      }
      return false;
    }

    // Autocomplete suggestions
    document.getElementById('site-search-input').addEventListener('input', function(e) {
      const query = e.target.value.trim().toLowerCase();
      const suggestionsDiv = document.getElementById('site-search-suggestions');
      const resultsDiv = document.getElementById('site-search-results');
      if (!query) {
        suggestionsDiv.style.display = 'none';
        suggestionsDiv.innerHTML = '';
        resultsDiv.innerHTML = ''; // <-- This line clears the results when search is erased
        return;
      }
      let suggestions = sitePages
        .filter(page => page.title.toLowerCase().includes(query) || page.content.toLowerCase().includes(query))
        .map(page => page.title)
        .slice(0, 5);
      if (suggestions.length) {
        suggestionsDiv.style.display = 'block';
        suggestionsDiv.innerHTML = suggestions.map(s => `<div class="suggestion-item" tabindex="0">${s}</div>`).join('');
      } else {
        suggestionsDiv.style.display = 'none';
        suggestionsDiv.innerHTML = '';
      }
    });

    // Keyboard navigation for suggestions
    document.getElementById('site-search-suggestions').addEventListener('click', function(e) {
      if (e.target.classList.contains('suggestion-item')) {
        document.getElementById('site-search-input').value = e.target.textContent;
        document.getElementById('site-search-suggestions').style.display = 'none';
        document.getElementById('site-search-form').dispatchEvent(new Event('submit'));
      }
    });
  </script>
</body>
</html>